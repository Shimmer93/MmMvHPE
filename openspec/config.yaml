schema: spec-driven

context: |
  Project: MMHPE (Multimodal Multiview Human Pose Estimation), a Python codebase for training, evaluation, and inference.
  Main entrypoint: main.py.
  Workflow: config-driven runs from configs/, outputs/checkpoints/artifacts under logs/.

  Tech stack:
  - Python >= 3.12 on Linux
  - PyTorch + Lightning
  - CUDA-sensitive deps (CUDA 12.4 target): torch, spconv-cu124, flash-attn, mmcv, etc.
  - Data/model configs in YAML

  Environment and execution conventions:
  - Use uv for dependency and command execution.
  - Install with: uv sync
  - Run with: uv run python ...
  - If CUDA/environment assumptions change, update pyproject.toml and do NOT edit uv.lock manually.

  Repository structure:
  - configs/: experiment configs
  - datasets/: dataset classes and transforms
  - models/: encoders, aggregators, heads, model API
  - losses/, metrics/, misc/: training/eval utilities
  - tools/: preprocessing and helper scripts
  - docs/: onboarding + implementation documentation
  - logs/: run outputs

  Documentation conventions:
  - Keep source comments short and necessary.
  - Put high-level intent, tricky details, and usage examples in docs/.
  - For scripts, include concrete command-line usage examples.

  Git convention:
  - Do not create commits unless the user explicitly asks.

rules:
  proposal:
    - Explain why the change is needed for MMHPE training/evaluation/prediction workflow.
    - List affected modalities/datasets/components explicitly (RGB, depth, LiDAR, mmWave when relevant).
    - Include scope boundaries and non-goals to avoid oversized changes.
    - Describe expected impact on configs and runtime outputs in logs/.
  specs:
    - Define requirements with concrete input/output expectations and key tensor/data shapes when relevant.
    - State compatibility requirements for existing config-driven runs from configs/.
    - Include at least one scenario per requirement with clear pass/fail behavior.
    - Call out dataset split assumptions, camera conventions, or coordinate-frame assumptions if touched.
  design:
    - Map the design to current architecture paths (main.py, datasets/data_api.py, models/model_api.py, configs/).
    - Document tradeoffs and failure modes (performance, CUDA dependency, backward compatibility).
    - Specify where docs/ updates are needed when behavior or usage changes.
    - Avoid unnecessary framework churn; prefer incremental integration with current modules.
  tasks:
    - Break tasks into small, verifiable steps with concrete file paths.
    - Include implementation, validation, and documentation updates (docs/) as explicit tasks.
    - Include runnable validation commands using uv run.
    - Do not include any commit task unless explicitly requested by the user.
